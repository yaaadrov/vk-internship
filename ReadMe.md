# VK Internship

Репозиторий содержит результаты участия в отброе на стажировку VK Internship. В задании решается задача геоаналитики: требуется предсказать успешность объекта ритейла. Решение содержит (1) генерацию признаков, (2) обучение модели и (3) предсказание

## Данные
1. `train.csv` — обучающая выборка
2. `test.csv` — тестовая выборка
3. `sample_submission.csv` — образец оформления предсказания
4. `features.csv` — дополнительные признаки

## Файлы
1. `features.py` — файл, генерирующий признаки
2. `train.py` — код обучения модели
3. `submission.py` — генерация предсказаний
4. `submission.csv` — предсказания для тестовой выборки

## Инструкция по запуску

1. Файл `features.py` получает данные `train.csv` и `test.csv`, а также дополнительные признаки `features.csv`, и генерирует признаки следующим образом:
   * Для каждого наблюдения из `train.csv` и `test.csv` подбираются 5 ближайших соседей из `features.py`;
   * Соответствующие значения признаков усредняются;
   * Осуществляется масштабирование признаков `lat` и `lon`;
   * Осуществляется удаление лишних признаков, выявленных с помощью (1) корреляционного анализа и (2) оценки важностей признаков через feature_importances_
   * Подготовленные данные сохраняются в папку `results`.

2. Файл `train.py` получает подготовленные данные для обучения, создает модель `LGBMRegressor` с гиперпараметрами, подобранными с помощью `optuna`, обучает модель на подготовленных данных и сохраняет обученную модель в папку `results`

3. Файл `submission.py` получает подготолвенные тестовые данные, образец оформления предсказания `sample_submission.csv` и обученную модель, генерирует предсказания и созраняет их в файл `submission.csv`
